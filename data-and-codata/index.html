
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mydomain.org/mysite/data-and-codata/">
      
      
        <link rel="prev" href="../language-manual/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Data and codata - Coal</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-and-codata" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Coal" class="md-header__button md-logo" aria-label="Coal" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Coal
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data and codata
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Coal" class="md-nav__button md-logo" aria-label="Coal" data-md-component="logo">
      
  <img src="../assets/logo.svg" alt="logo">

    </a>
    Coal
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../language-manual/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Language manual
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Data and codata
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Data and codata
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initial-algebras" class="md-nav__link">
    <span class="md-ellipsis">
      Initial algebras
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pattern-functors-and-fixed-points" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern functors and fixed points
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#duality" class="md-nav__link">
    <span class="md-ellipsis">
      Duality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algebras-and-folds" class="md-nav__link">
    <span class="md-ellipsis">
      Algebras and folds
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initial-algebras" class="md-nav__link">
    <span class="md-ellipsis">
      Initial algebras
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pattern-functors-and-fixed-points" class="md-nav__link">
    <span class="md-ellipsis">
      Pattern functors and fixed points
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#duality" class="md-nav__link">
    <span class="md-ellipsis">
      Duality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algebras-and-folds" class="md-nav__link">
    <span class="md-ellipsis">
      Algebras and folds
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="data-and-codata">Data and codata</h1>
<h2 id="initial-algebras">Initial algebras</h2>
<p>Data and codata are really "two sides of the same coin." This correspondence can be traced back to category theory, where precise formal meaning is given to these concepts. </p>
<p>An algebraic data type can be understood as the <a href="https://en.wikipedia.org/wiki/Initial_algebra">initial algebra</a> of a functor. Intuitively, this means that it provides the smallest, well-founded solution to a type equation &mdash; one that can be consumed by a fold (a catamorphism). </p>
<p align="center">
  <img alt="Fold" src="../assets/tex/png/fold.png" />
</p>

<h2 id="pattern-functors-and-fixed-points">Pattern functors and fixed points</h2>
<p>Data types are built from constructors. Consider the <code>List</code> type, for example:</p>
<div class="highlight"><pre><span></span><code>type List&lt;t&gt; 
  = Nil
  | Cons(t, List&lt;t&gt;)
</code></pre></div>
<p>The <em>pattern functor</em> for a data type abstracts recursion by isolating one layer of the data structure, leaving the recursive portion as a parameter. For <code>List</code>, the corresponding pattern functor is:</p>
<div class="highlight"><pre><span></span><code>type ListF&lt;t, a&gt; 
  = NilF
  | ConsF(t, a)
</code></pre></div>
<p>In mathematical terms, this can be expressed by the equation:</p>
<div class="arithmatex">\[
F(X) = \mathsf{1} + (t \times X)
\]</div>
<p>where</p>
<ul>
<li><span class="arithmatex">\(\mathsf{1}\)</span> corresponds to <code>NilF</code>,</li>
<li><span class="arithmatex">\((t × X)\)</span> corresponds to <code>ConsF(t, a)</code>.</li>
</ul>
<p>The actual recursive type is the <a href="https://en.wikipedia.org/wiki/Fixed_point_(mathematics)">fixed point</a> of this functor:</p>
<div class="arithmatex">\[
\texttt{List&lt;t&gt;} \cong \mu F \cong F(\mu F)
\]</div>
<h2 id="duality">Duality</h2>
<p>Reversing the arrows is a recurring theme in category theory. Products and sum types describe ways of combining values: a product collects multiple values into one, while a sum, or <em>disjoint union</em>, represents a choice between alternatives. A disjoint union is sometimes also referred to as a <em>coproduct</em>. The reason is that a product is defined by a universal property that allows you to extract its components, whereas a coproduct is defined dually: it allows you to inject a value from one of the alternatives and to handle each case uniquely. </p>
<p align="center">
  <img alt="Product and coproduct" src="../assets/tex/png/product_coproduct.png" />
</p>

<p>In other words, a disjoint union is the categorical dual of a product.</p>
<h2 id="algebras-and-folds">Algebras and folds</h2>
<p>An <em>algebra</em> for a functor <span class="arithmatex">\(F\)</span> is a type <span class="arithmatex">\(A\)</span> (the <em>carrier</em>) together with a function <span class="arithmatex">\(F(A) \rightarrow A\)</span>. This function is called the <em>structure map</em> and it is precisely what the pattern matching clauses (along with the <code>@</code>-pattern syntax) in <code>fold</code> expressions describe:</p>
<div class="highlight"><pre><span></span><code>fold(xs) {
  Nil           =&gt; 0
  Cons(x, @acc) =&gt; x + acc
}
</code></pre></div>
<p>The <em>initial</em> algebra <span class="arithmatex">\((\mu F, \text{in})\)</span> is defined by the canonical map <span class="arithmatex">\(\text{in} : F(\mu F) \rightarrow \mu F\)</span>. The carrier of this algebra is the data type itself (i.e., <code>List&lt;t&gt;</code> in this example). The fact that this is an initial object means that, for evey other algebra <span class="arithmatex">\(A\)</span>, there is a unique function <span class="arithmatex">\(h : \mu F \rightarrow A\)</span> that makes the diagram commute. That unique morphism is precisely what the <code>fold</code> operator computes.</p>
<p>In the other direction, a codata type corresponds to the <a href="https://en.wikipedia.org/wiki/Initial_algebra#Final_coalgebra">final coalgebra</a> of a functor: it is the largest (potentially infinite) solution that can be observed or generated by an unfold (anamorphism). In this description, algebras and coalgebras are each others’ duals. By simply reversing the direction of the arrows in their diagrams, an algebra turns into a coalgebra and vice versa.</p>
<p align="center">
  <img alt="Duality" src="../assets/tex/png/fold_unfold.png" />
</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>